<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Computing slopes &mdash; incflo 21.10-dev documentation</title>
      <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Creating the MAC velocities" href="BuildingMacVelocities.html" />
    <link rel="prev" title="Time Step – MOL" href="TimeStep.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> incflo
          </a>
              <div class="version">
                21.10-dev
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="GettingStarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="Inputs_Chapter.html">Run-time Inputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="ManagingGridHierarchy_Chapter.html">Gridding and Load Balancing</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="Fluids_Chapter.html">Solving the Fluid Equations</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="FluidEquations.html">Fluid Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="FluidEquations.html#fluid-equations">Fluid Equations</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="FluidTimeDiscretization.html">Time Discretization</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="TimeStep.html">Time Step – MOL</a></li>
<li class="toctree-l3"><a class="reference internal" href="TimeStep.html#time-step-godunov">Time Step – Godunov</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Computing slopes</a></li>
<li class="toctree-l3"><a class="reference internal" href="BuildingMacVelocities.html">Creating the MAC velocities</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="EB.html">Embedded Boundaries</a></li>
<li class="toctree-l1"><a class="reference internal" href="Debugging.html">Debugging</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">incflo</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="Fluids_Chapter.html">Solving the Fluid Equations</a> &raquo;</li>
          <li><a href="FluidTimeDiscretization.html">Time Discretization</a> &raquo;</li>
      <li>Computing slopes</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/Slopes.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="computing-slopes">
<h1>Computing slopes<a class="headerlink" href="#computing-slopes" title="Permalink to this headline"></a></h1>
<p>Slopes are computed one direction at a time for each scalar and each
velocity component.</p>
<p>We use the second order Monotonized Central (MC)
limiter (van Leer, 1977). The scheme is described below for the u-velocity.</p>
<p>The limiter computes the slope at cell “i” by combining the left, central
and right u-variation “du”:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nv">du_l</span> <span class="o">=</span> u<span class="o">(</span>i<span class="o">)</span> - u<span class="o">(</span>i-1<span class="o">)</span>               <span class="o">=</span> left variation
<span class="nv">du_c</span> <span class="o">=</span> <span class="m">0</span>.5 * <span class="o">(</span> u<span class="o">(</span>i+1<span class="o">)</span> - u<span class="o">(</span>i-1<span class="o">)</span> <span class="o">)</span>   <span class="o">=</span> central <span class="o">(</span>umlimited<span class="o">)</span> variation
<span class="nv">du_r</span> <span class="o">=</span> u<span class="o">(</span>i+1<span class="o">)</span> - u<span class="o">(</span>i<span class="o">)</span>               <span class="o">=</span> right variation
</pre></div>
</div>
<p>Finally, the u-variation at cell “i” is given by :</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>du<span class="o">(</span>i<span class="o">)</span> <span class="o">=</span> sign<span class="o">(</span>du_c<span class="o">)</span> * min<span class="o">(</span><span class="m">2</span><span class="p">|</span>du_l<span class="p">|</span>, <span class="p">|</span>du_c<span class="p">|</span>, <span class="m">2</span><span class="p">|</span>du_r<span class="p">|</span><span class="o">))</span> <span class="k">if</span> du_l*du_r &gt; <span class="m">0</span>
du<span class="o">(</span>i<span class="o">)</span> <span class="o">=</span> <span class="m">0</span>                                           otherwise
</pre></div>
</div>
<p>The above procedure is applied direction by direction.</p>
<p>BOUNDARY CONDITIONS
When periodic or Neumann’s BCs are imposed, the scheme can be applied
without any change since the ghost cells at the boundary are filled
by either periodicity or by extrapolation.
For Dirichlet’s BCs in the transversal direction, the scheme can again
be applied as is since the velocity is known at the first ghost cell
out of the domain.
However, for Dirichlet’s BCs in the longitudinal direction, the velocity
is not known outside the domain since the BC is applied directly at the first
valid node which lies on the boundary itself. Therefore, the scheme must be
arranged as follows to use ONLY values from inside the domain.
For a left boundary (i=0), the u-variations are:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nv">du_l</span> <span class="o">=</span> <span class="m">0</span>                             Dont use values on the left
<span class="nv">du_c</span> <span class="o">=</span> -1.5*u<span class="o">(</span><span class="m">0</span><span class="o">)</span> + <span class="m">2</span>*u<span class="o">(</span><span class="m">1</span><span class="o">)</span> -0.5*u<span class="o">(</span><span class="m">2</span><span class="o">)</span>  2nd order right-biased
<span class="nv">du_r</span> <span class="o">=</span> u<span class="o">(</span><span class="m">1</span><span class="o">)</span> - u<span class="o">(</span><span class="m">0</span><span class="o">)</span>                   Right variation
</pre></div>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="TimeStep.html" class="btn btn-neutral float-left" title="Time Step – MOL" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="BuildingMacVelocities.html" class="btn btn-neutral float-right" title="Creating the MAC velocities" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017-2018, Incflo Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>